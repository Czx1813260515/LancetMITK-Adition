<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkDataStorageSelection.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#ifndef mitkDataStorageSelection_h
#define mitkDataStorageSelection_h

#include "MitkDataTypesExtExports.h"

#include &lt;mitkCommon.h&gt;
#include &lt;mitkDataStorage.h&gt;
#include &lt;mitkNodePredicateBase.h&gt;

#include &lt;set&gt;

namespace mitk
{
  class BaseProperty;
  class PropertyList;

  class MITKDATATYPESEXT_EXPORT DataStorageSelection : public itk::Object
  {
  public:
    typedef std::vector&lt;mitk::DataNode *&gt; Nodes;
    typedef Message1&lt;const mitk::DataNode *&gt; DataNodeEvent;

    DataNodeEvent NodeChanged;
    DataNodeEvent NodeAdded;
    DataNodeEvent NodeRemoved;
    Message2&lt;const mitk::DataNode *, const mitk::BaseProperty *&gt; PropertyChanged;

<span style = "background-color:#fdd">    mitkClassMacroItkParent(DataStorageSelection, itk::Object);</span>

<span style = "background-color:#fdd">    mitkNewMacro2Param(DataStorageSelection, DataStorage *, bool);
    mitkNewMacro3Param(DataStorageSelection, DataStorage *, NodePredicateBase *, bool);</span>

  protected:
    DataStorageSelection(mitk::DataStorage *_DataStorage, bool _AutoAddNodes);
    DataStorageSelection(mitk::DataStorage *_DataStorage, mitk::NodePredicateBase *_Predicate, bool _AutoAddNodes);

  public:
    ~DataStorageSelection() override;

    ///
    /// Get the DataStorage.
    ///
    mitk::DataStorage::Pointer GetDataStorage() const;
    ///
    /// Get the predicate.
    ///
    mitk::NodePredicateBase::Pointer GetPredicate() const;
    ///
    /// Returns the size of this selection
    ///
    unsigned int GetSize() const;
    ///
    /// Get node at a specific model index.
    ///
    mitk::DataNode::Pointer GetNode(unsigned int index) const;
    ///
    /// Returns the first node, same as calling GetNode(0)
    ///
    mitk::DataNode::Pointer GetNode() const;
    ///
    /// Returns a copy of the node-vector
    ///
    std::vector&lt;mitk::DataNode *&gt; GetNodes() const;
    ///
    /// \see m_AutoAddNodes
    ///
    bool DoesAutoAddNodes() const;

  public:
    ///
    /// Removes all nodes, sets node as new first element
    ///
    DataStorageSelection &amp;operator=(mitk::DataNode *node);
    ///
    /// Removes all nodes, sets node as new first element
    ///
    DataStorageSelection &amp;operator=(mitk::DataNode::Pointer node);
    ///
    /// Sets the DataStorage.
    ///
    virtual void SetDataStorage(mitk::DataStorage *_DataStorage);
    ///
    /// Sets the predicate. &lt;b&gt;QmitkDataStorageTableModel is owner of the predicate!&lt;/b&gt;
    ///
    virtual void SetPredicate(mitk::NodePredicateBase *_Predicate);
    ///
    /// Add a node (if not already there)
    ///
    virtual void AddNode(const mitk::DataNode *node);
    ///
    /// Removes a node
    ///
    virtual void RemoveNode(const mitk::DataNode *node);
    ///
    /// Removes a node
    ///
    virtual void RemoveAllNodes();
    ///
    /// Called whenever an itk Object this class holds gets deleted or modified
    ///
    virtual void ObjectChanged(const itk::Object *caller, const itk::EventObject &amp;event);

  protected:
    ///
    /// Find a node in the list by the given prop
    ///
    mitk::DataNode::Pointer FindNode(const mitk::BaseProperty *prop) const;
    ///
    /// Find a node in the list by the given proplist
    ///
    mitk::DataNode::Pointer FindNode(const mitk::PropertyList *propList) const;
    ///
    /// Removes all nodes and fill the vector again
    ///
    void Reset();
    ///
    /// If a node is already in this list, all listeners will be removed
    ///
    void RemoveListener(mitk::DataNode *node);
    ///
    /// Adds listeners for modified/delete event, for the propertylists
    /// modified/delete and for the modified/delete event of each property
    /// and stores listener tags
    ///
    void AddListener(mitk::DataNode *node);

  protected:
    ///
    /// Pointer to the DataStorage from which the nodes are selected
    ///
    mitk::DataStorage *m_DataStorage;
    ///
    /// DeleteTag for the DataStorage
    ///
    unsigned int m_DataStorageDeletedTag;
    ///
    /// Holds the predicate that defines this SubSet of Nodes. If m_Predicate
    /// is nullptr all Nodes will be selected.
    ///
    mitk::NodePredicateBase::Pointer m_Predicate;
    ///
    /// Holds all selected Nodes.
    ///
    std::vector&lt;mitk::DataNode *&gt; m_Nodes;
    ///
    /// \brief Maps a node to a modified observer tag.
    ///
    std::map&lt;mitk::DataNode *, unsigned long&gt; m_NodeModifiedObserverTags;
    ///
    /// \brief Maps a propertylist to a modified observer tag.
    ///
    std::map&lt;mitk::PropertyList *, unsigned long&gt; m_PropertyListModifiedObserverTags;
    ///
    /// \brief Maps a propertylist to a delete observer tag.
    ///
    std::map&lt;mitk::PropertyList *, unsigned long&gt; m_PropertyListDeletedObserverTags;
    ///
    /// \brief Maps a property to  a modified observer tag.
    ///
    std::map&lt;mitk::BaseProperty *, unsigned long&gt; m_PropertyModifiedObserverTags;
    ///
    /// \brief Maps a property to a delete observer tag.
    ///
    std::map&lt;mitk::BaseProperty *, unsigned long&gt; m_PropertyDeletedObserverTags;
    ///
    /// If set to true no event processing will be performed
    ///
    bool m_SelfCall;
    ///
    /// Saves if new nodes are automatically added to this selection
    ///
    bool m_AutoAddNodes;
  };
}

#endif // mitkDataStorageSelection_h</pre>
	</body>
</html>