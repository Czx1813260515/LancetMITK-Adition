<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkDICOMGDCMImageFrameInfo.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkDICOMGDCMImageFrameInfo.h"

mitk::DICOMGDCMImageFrameInfo
::DICOMGDCMImageFrameInfo(const std::string&amp; filename, unsigned int frameNo)
<span style = "background-color:#fdd">:DICOMDatasetAccessingImageFrameInfo(filename, frameNo)
,m_TagForValue()
{
}</span>

mitk::DICOMGDCMImageFrameInfo
::DICOMGDCMImageFrameInfo(const DICOMImageFrameInfo::Pointer&amp; frameinfo)
<span style = "background-color:#fdd">:DICOMDatasetAccessingImageFrameInfo(frameinfo-&gt;Filename, frameinfo-&gt;FrameNo)
,m_TagForValue()
{
}</span>

mitk::DICOMGDCMImageFrameInfo
::DICOMGDCMImageFrameInfo(const DICOMImageFrameInfo::Pointer&amp; frameinfo, gdcm::Scanner::TagToValue const&amp; tagToValueMapping)
<span style = "background-color:#fdd">:DICOMDatasetAccessingImageFrameInfo(frameinfo-&gt;Filename, frameinfo-&gt;FrameNo)
,m_TagForValue(tagToValueMapping)
{
}</span>

mitk::DICOMGDCMImageFrameInfo::
~DICOMGDCMImageFrameInfo()
<span style = "background-color:#fdd">{
}</span>

mitk::DICOMDatasetFinding
mitk::DICOMGDCMImageFrameInfo
::GetTagValueAsString(const DICOMTag&amp; tag) const
<span style = "background-color:#fdd">{
  const auto mappedValue = m_TagForValue.find( gdcm::Tag(tag.GetGroup(), tag.GetElement()) );
  DICOMDatasetFinding result;</span>

<span style = "background-color:#fdd">  if (mappedValue != m_TagForValue.cend())</span>
  {
<span style = "background-color:#fdd">    result.isValid = true;</span>

<span style = "background-color:#fdd">    if (mappedValue-&gt;second != nullptr)</span>
    {
<span style = "background-color:#fdd">      std::string s(mappedValue-&gt;second);</span>
      try
      {
<span style = "background-color:#fdd">        result.value = s.erase(s.find_last_not_of(" \n\r\t")+1);</span>
      }
      catch(...)
<span style = "background-color:#fdd">      {
        result.value = s;
      }
    }</span>
    else
    {
<span style = "background-color:#fdd">      result.value = "";</span>
    }
<span style = "background-color:#fdd">  }</span>
  else
  {
<span style = "background-color:#fdd">    const DICOMTag tagImagePositionPatient = DICOMTag(0x0020,0x0032); // Image Position (Patient)
    const DICOMTag    tagImageOrientation = DICOMTag(0x0020, 0x0037); // Image Orientation</span>

<span style = "background-color:#fdd">    if (tag == tagImagePositionPatient)</span>
    {
<span style = "background-color:#fdd">      result.isValid = true;
      result.value = std::string("0\\0\\0");
    }
    else if (tag == tagImageOrientation)</span>
    {
<span style = "background-color:#fdd">      result.isValid = true;
      result.value = std::string("1\\0\\0\\0\\1\\0");
    }</span>
    else
    {
<span style = "background-color:#fdd">      result.isValid = false;
      result.value = "";</span>
    }
  }
<span style = "background-color:#fdd">  return result;
}</span>

mitk::DICOMDatasetAccess::FindingsListType
mitk::DICOMGDCMImageFrameInfo::GetTagValueAsString(const DICOMTagPath&amp; path) const
<span style = "background-color:#fdd">{
  FindingsListType result;
  if (path.Size() == 1 &amp;&amp; path.IsExplicit())</span>
  {
<span style = "background-color:#fdd">    result.push_back(this-&gt;GetTagValueAsString(path.GetFirstNode().tag));</span>
  }
<span style = "background-color:#fdd">  return result;
}</span>

std::string
mitk::DICOMGDCMImageFrameInfo
::GetFilenameIfAvailable() const
<span style = "background-color:#fdd">{
  return this-&gt;Filename;
}</span></pre>
	</body>
</html>