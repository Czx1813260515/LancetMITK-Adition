<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkSurfaceToPointSetFilter.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkSurfaceToPointSetFilter.h"

// mitk headers
#include "mitkPointSet.h"

// itk headers
#include "itkMatrix.h"
#include "itkVector.h"

// vtk headers
#include &lt;vtkCleanPolyData.h&gt;
#include &lt;vtkPolyData.h&gt;

mitk::SurfaceToPointSetFilter::SurfaceToPointSetFilter()
<span style = "background-color:#fdd">{
  this-&gt;SetNumberOfIndexedOutputs(1);
}</span>

mitk::SurfaceToPointSetFilter::~SurfaceToPointSetFilter()
<span style = "background-color:#fdd">{
}</span>

void mitk::SurfaceToPointSetFilter::GenerateData()
<span style = "background-color:#fdd">{
  if (m_InputSurface.IsNull())</span>
  {
<span style = "background-color:#fdd">    this-&gt;SetNthOutput(0, nullptr);
    m_ErrorMessage = "Error in SurfaceToPointSetFilter: Input is not set correctly.";
    return;</span>
  }
<span style = "background-color:#fdd">  mitk::PointSet::Pointer result = mitk::PointSet::New();</span>

<span style = "background-color:#fdd">  vtkPolyData *points = this-&gt;m_InputSurface-&gt;GetVtkPolyData();
  vtkCleanPolyData *cleaner = vtkCleanPolyData::New();
  cleaner-&gt;PieceInvariantOff();
  cleaner-&gt;ConvertLinesToPointsOff();
  cleaner-&gt;ConvertPolysToLinesOff();
  cleaner-&gt;ConvertStripsToPolysOff();
  cleaner-&gt;PointMergingOn();
  cleaner-&gt;SetInputData(points);
  cleaner-&gt;Update();</span>

<span style = "background-color:#fdd">  vtkPolyData *mergedPoints = cleaner-&gt;GetOutput();</span>

  // generate filter output
<span style = "background-color:#fdd">  for (int i = 0; i &lt; mergedPoints-&gt;GetNumberOfPoints(); i++)</span>
  {
<span style = "background-color:#fdd">    mitk::Point3D currentPoint;
    currentPoint[0] = mergedPoints-&gt;GetPoint(i)[0];
    currentPoint[1] = mergedPoints-&gt;GetPoint(i)[1];
    currentPoint[2] = mergedPoints-&gt;GetPoint(i)[2];
    result-&gt;InsertPoint(i, currentPoint);
  }
  this-&gt;SetNthOutput(0, result);</span>
  //-------------------------

<span style = "background-color:#fdd">  cleaner-&gt;Delete();
}</span>

void mitk::SurfaceToPointSetFilter::SetInput(mitk::Surface::Pointer InputSurface)
<span style = "background-color:#fdd">{
  m_InputSurface = InputSurface;
  this-&gt;Modified();
}</span>

std::string mitk::SurfaceToPointSetFilter::GetErrorMessage()
<span style = "background-color:#fdd">{
  return this-&gt;m_ErrorMessage;
}</span></pre>
	</body>
</html>