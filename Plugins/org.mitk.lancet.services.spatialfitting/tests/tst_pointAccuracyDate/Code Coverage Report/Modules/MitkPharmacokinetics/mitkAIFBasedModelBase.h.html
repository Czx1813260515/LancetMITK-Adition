<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkAIFBasedModelBase.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/
#ifndef AIFBASEDMODELBASE_H
#define AIFBASEDMODELBASE_H


#include "MitkPharmacokineticsExports.h"
#include "mitkModelBase.h"
#include "itkArray2D.h"

namespace mitk
{

  /** \class AIFBasedModelBase
   * \brief Base Class for all physiological perfusion models using an Aterial Input Function
   * All AIF based models come with an array of AIF values and the corresponding TimeGrid ( AIF(t))
   * This class provides functions for setting the AIF Values and optionally a specific AIF TimeGrid.
   * It also provides a method for interpolation of the AIF source array to a specified Timegrid that differs from
   * AIFTimeGrid. The AIF must be set with an itk::Array. If no AIFTimeGrid is specified with the Setter, it is assumed
   * that the AIFTimeGrid is the same as the ModelTimegrid (e.g. AIF is derived from data set to be fitted). In this
   * case, AIFvalues must have the same length as ModelTimeGrid, otherwise an exception is generated*/
  class MITKPHARMACOKINETICS_EXPORT AIFBasedModelBase : public mitk::ModelBase
  {
  public:

    typedef AIFBasedModelBase Self;
    typedef ModelBase Superclass;
    typedef itk::SmartPointer&lt; Self &gt;                            Pointer;
    typedef itk::SmartPointer&lt; const Self &gt;                      ConstPointer;


    /** Run-time type information (and related methods). */
<span style = "background-color:#fdd">    itkTypeMacro(PhysiologciModelBase, AIFBasedModelBase);</span>


    static const std::string NAME_STATIC_PARAMETER_AIF;
    static const std::string NAME_STATIC_PARAMETER_AIFTimeGrid;

    static const std::string UNIT_STATIC_PARAMETER_AIF;
    static const std::string UNIT_STATIC_PARAMETER_AIFTimeGrid;

    /** Typedef for Aterial InputFunction AIF(t)*/
    typedef itk::Array&lt;double&gt; AterialInputFunctionType;

<span style = "background-color:#fdd">    itkGetConstReferenceMacro(AterialInputFunctionValues, AterialInputFunctionType);
    itkGetConstReferenceMacro(AterialInputFunctionTimeGrid, TimeGridType);</span>

<span style = "background-color:#fdd">    itkSetMacro(AterialInputFunctionValues, AterialInputFunctionType);
    itkSetMacro(AterialInputFunctionTimeGrid, TimeGridType);</span>

    std::string GetXAxisName() const override;

    std::string GetXAxisUnit() const override;

    std::string GetYAxisName() const override;

    std::string GetYAxisUnit() const override;

    /** Returns the TimeGrid used for the AIF. Either the externally set AIF time grid
     * or the time grid of the model if nothing is set.*/
    const TimeGridType&amp; GetCurrentAterialInputFunctionTimeGrid() const;

    /** Returns the Aterial Input function matching currentTimeGrid
     *  The original values are interpolated to the passed TimeGrid
     * if currentTimeGrid.Size() = 0 , the Original AIF will be returned*/
    const AterialInputFunctionType GetAterialInputFunction(TimeGridType currentTimeGrid) const;

    ParameterNamesType GetStaticParameterNames() const override;
    ParametersSizeType GetNumberOfStaticParameters() const override;
    ParamterUnitMapType GetStaticParameterUnits() const override;


  protected:
    AIFBasedModelBase();
    ~AIFBasedModelBase() override;

    /** Reimplementation that checks if AIF and timegrid settings are valid.
     * @param [out] error Set internally to indicate the error reason if method returns false. Is used by GetSignal() for the
     * exception comment.
     * @return Returns true if the model is valid and can compute a signal. Otherwise it returns false.*/
    bool ValidateModel(std::string&amp; error) const override;

    void PrintSelf(std::ostream&amp; os, ::itk::Indent indent) const override;

    void SetStaticParameter(const ParameterNameType&amp; name,
                                    const StaticParameterValuesType&amp; values) override;

    StaticParameterValuesType GetStaticParameterValue(const ParameterNameType&amp; name) const
    override;

    TimeGridType m_AterialInputFunctionTimeGrid;
    AterialInputFunctionType m_AterialInputFunctionValues;


  private:


    //No copy constructor allowed
    AIFBasedModelBase(const Self&amp; source);
    void operator=(const Self&amp;);  //purposely not implemented


  };
}
#endif // AIFBASEDMODELBASE_H</pre>
	</body>
</html>