<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkModelFitIOActivator.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/


#include &lt;usModuleActivator.h&gt;
#include &lt;usModuleContext.h&gt;

#include &lt;mitkCoreServices.h&gt;
#include &lt;mitkIPropertyDescriptions.h&gt;
#include &lt;mitkIPropertyPersistence.h&gt;
#include &lt;mitkModelFitConstants.h&gt;
#include &lt;mitkScalarListLookupTablePropertySerializer.h&gt;

namespace mitk
{

/*
 * This is the module activator for the IO aspects of the "ModelFit" module.
 */
class ModelFitIOActivator : public us::ModuleActivator
{
public:
  void registerProperty(const std::string&amp; name, const std::string&amp; key, const std::string&amp; description)
<span style = "background-color:#dfd">  {
    mitk::CoreServicePointer&lt;mitk::IPropertyDescriptions&gt; propDescService(mitk::CoreServices::GetPropertyDescriptions());
    propDescService-&gt;AddDescription(name, description);</span>

<span style = "background-color:#dfd">    mitk::PropertyPersistenceInfo::Pointer ppi = mitk::PropertyPersistenceInfo::New();
    ppi-&gt;SetNameAndKey(name, key);</span>

<span style = "background-color:#dfd">    mitk::CoreServicePointer&lt;mitk::IPropertyPersistence&gt; propPersistenceService(mitk::CoreServices::GetPropertyPersistence());
    propPersistenceService-&gt;AddInfo(ppi, true);
  }</span>

  void registerProperty(const std::string&amp; name, const std::string&amp; key, const std::string&amp; description, const PropertyPersistenceInfo::DeserializationFunctionType &amp;deFnc, const PropertyPersistenceInfo::SerializationFunctionType &amp;serFnc)
<span style = "background-color:#dfd">  {
    mitk::CoreServicePointer&lt;mitk::IPropertyDescriptions&gt; propDescService(mitk::CoreServices::GetPropertyDescriptions());
    propDescService-&gt;AddDescription(name, description);</span>

<span style = "background-color:#dfd">    mitk::PropertyPersistenceInfo::Pointer ppi = mitk::PropertyPersistenceInfo::New();
    ppi-&gt;SetNameAndKey(name, key);
    ppi-&gt;SetDeserializationFunction(deFnc);
    ppi-&gt;SetSerializationFunction(serFnc);</span>

<span style = "background-color:#dfd">    mitk::CoreServicePointer&lt;mitk::IPropertyPersistence&gt; propPersistenceService(mitk::CoreServices::GetPropertyPersistence());
    propPersistenceService-&gt;AddInfo(ppi, true);
  }</span>

  void Load(us::ModuleContext* /*context*/) override
<span style = "background-color:#dfd">  {</span>
    //register relevant properties
<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::INPUT_VARIABLES_PROPERTY_NAME(), "modelfit_input_variables", "Array of input variables used in/for a model fit.", PropertyPersistenceDeserialization::deserializeXMLToScalarListLookupTableProperty, PropertyPersistenceSerialization::serializeScalarListLookupTablePropertyToXML);</span>

<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::PARAMETER_NAME_PROPERTY_NAME(), "modelfit_parameter_name", "Name of the parameter, that is represented by the data and how it is used in the function string (modelfit.model.function).");
    registerProperty(mitk::ModelFitConstants::PARAMETER_UNIT_PROPERTY_NAME(), "modelfit_parameter_unit", "Unit string of the Parameter. Is only used for display. Default value: \"\" (no unit)");
    registerProperty(mitk::ModelFitConstants::PARAMETER_SCALE_PROPERTY_NAME(), "modelfit_parameter_scale", "Scaling of the parameter. Default value: 1.");
    registerProperty(mitk::ModelFitConstants::PARAMETER_TYPE_PROPERTY_NAME(), "modelfit_parameter_type", "Type of the parameters. Default value: parameter. Other options: derived, criterion, evaluation.");</span>

<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::MODEL_TYPE_PROPERTY_NAME(), "modelfit_model_type", "Value specifies the type of model (helpfull for classification; e.g. MR perfusion)");
    registerProperty(mitk::ModelFitConstants::MODEL_NAME_PROPERTY_NAME(), "modelfit_model_name", "Name of the specific fit. Only used for display.");
    registerProperty(mitk::ModelFitConstants::MODEL_FUNCTION_PROPERTY_NAME(), "modelfit_model_function", "Function string, that specifies the model and will be parsed, to plot the curves based on the parameter. Optional parameter that must not be set.");
    registerProperty(mitk::ModelFitConstants::MODEL_FUNCTION_CLASS_PROPERTY_NAME(), "modelfit_model_functionClass", "ID of the model class implementation.");
    registerProperty(mitk::ModelFitConstants::MODEL_X_PROPERTY_NAME(), "modelfit_model_x", "Name of the forumar parameter 'x', that is specified on the x axis. Only needed if model function string is set and formular must be parsed.");</span>

<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::XAXIS_NAME_PROPERTY_NAME(), "modelfit_xaxis_name", "Display name of the x axis.");
    registerProperty(mitk::ModelFitConstants::XAXIS_UNIT_PROPERTY_NAME(), "modelfit_xaxis_unit", "Unit of the x axis.");</span>

<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::YAXIS_NAME_PROPERTY_NAME(), "modelfit_yaxis_name", "Display name of the y axis.");
    registerProperty(mitk::ModelFitConstants::YAXIS_UNIT_PROPERTY_NAME(), "modelfit_yaxis_unit", "Unit of the y axis.");</span>

<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::FIT_UID_PROPERTY_NAME(), "modelfit_fit_uid", "UID of the fit.");
    registerProperty(mitk::ModelFitConstants::FIT_NAME_PROPERTY_NAME(), "modelfit_fit_name", "Human readable name for the fit.");
    registerProperty(mitk::ModelFitConstants::FIT_TYPE_PROPERTY_NAME(), "modelfit_fit_type", "Type of the fit (e.g. ROI based or pixel based).");
    registerProperty(mitk::ModelFitConstants::FIT_INPUT_ROIUID_PROPERTY_NAME(), "modelfit_fit_input_roiUID", "UID of the ROI used for the fit.");
    registerProperty(mitk::ModelFitConstants::FIT_INPUT_DATA_PROPERTY_NAME(), "modelfit_fit_input_data", "Property containing input data directly stored in the fit information.");
    registerProperty(mitk::ModelFitConstants::FIT_STATIC_PARAMETERS_PROPERTY_NAME(), "modelfit_fit_staticParameters", "Property containing static parameters used for the fit.", PropertyPersistenceDeserialization::deserializeXMLToScalarListLookupTableProperty, PropertyPersistenceSerialization::serializeScalarListLookupTablePropertyToXML);</span>

    //legacy properties for backwards compatibility
<span style = "background-color:#dfd">    registerProperty(mitk::ModelFitConstants::LEGACY_UID_PROPERTY_NAME(), "data_uid", "UID used to identify data in an MITK session.");
    registerProperty(mitk::ModelFitConstants::LEGACY_FIT_INPUT_IMAGEUID_PROPERTY_NAME(), "modelfit_fit_input_imageUID", "UID of the input image that used to fit the model.");
  }</span>

  void Unload(us::ModuleContext* ) override
<span style = "background-color:#dfd">  {
  }</span>

};
}

<span style = "background-color:#dfd">US_EXPORT_MODULE_ACTIVATOR(mitk::ModelFitIOActivator)</span></pre>
	</body>
</html>