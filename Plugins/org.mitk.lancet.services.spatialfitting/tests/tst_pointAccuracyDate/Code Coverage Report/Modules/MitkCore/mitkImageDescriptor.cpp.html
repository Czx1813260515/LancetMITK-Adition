<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkImageDescriptor.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/
#include "mitkImageDescriptor.h"

mitk::ImageDescriptor::ImageDescriptor()
<span style = "background-color:#fdd">{</span>
  // initialize the dimensions array
<span style = "background-color:#fdd">  for (auto &amp;elem : m_Dimensions)</span>
  {
<span style = "background-color:#fdd">    elem = 1;
  }</span>

<span style = "background-color:#fdd">  this-&gt;m_NumberOfChannels = 0;
}</span>

// FIXME manage memory flag
void mitk::ImageDescriptor::AddNewChannel(mitk::PixelType ptype, const char *name)
<span style = "background-color:#fdd">{
  size_t elems = 1;</span>

<span style = "background-color:#fdd">  for (unsigned int i = 0; i &lt; this-&gt;m_NumberOfDimensions; i++)
    elems *= this-&gt;m_Dimensions[i];</span>

<span style = "background-color:#fdd">  mitk::ChannelDescriptor desc(ptype, elems);</span>

<span style = "background-color:#fdd">  this-&gt;m_ChannelDesc.push_back(desc);</span>

<span style = "background-color:#fdd">  if (name == nullptr)
    m_ChannelNames.push_back("Unnamed [" + ptype.GetPixelTypeAsString() + "]");</span>
  else
<span style = "background-color:#fdd">    m_ChannelNames.push_back(name);</span>

<span style = "background-color:#fdd">  this-&gt;m_NumberOfChannels++;</span>

<span style = "background-color:#fdd">  return;
}</span>

void mitk::ImageDescriptor::Initialize(const ImageDescriptor::Pointer refDescriptor, unsigned int channel)
<span style = "background-color:#fdd">{</span>
  // initialize the members holding dimension information
<span style = "background-color:#fdd">  this-&gt;m_NumberOfChannels = refDescriptor-&gt;GetNumberOfChannels();
  this-&gt;m_NumberOfDimensions = refDescriptor-&gt;GetNumberOfDimensions();
  const unsigned int *refDims = refDescriptor-&gt;GetDimensions();</span>

  // copy the dimension information
<span style = "background-color:#fdd">  for (unsigned int i = 0; i &lt; this-&gt;m_NumberOfDimensions; i++)</span>
  {
<span style = "background-color:#fdd">    this-&gt;m_Dimensions[i] = refDims[i];
  }</span>

  // get the channel descriptor and store them and so the name of the channel
<span style = "background-color:#fdd">  mitk::ChannelDescriptor desc = refDescriptor-&gt;GetChannelDescriptor(channel);
  this-&gt;m_ChannelDesc.push_back(desc);
  this-&gt;m_ChannelNames.push_back(refDescriptor-&gt;GetChannelName(channel));
}</span>

void mitk::ImageDescriptor::Initialize(const unsigned int *dims, const unsigned int dim)
<span style = "background-color:#fdd">{
  this-&gt;m_NumberOfDimensions = dim;</span>

  // copy the dimension information
<span style = "background-color:#fdd">  for (unsigned int i = 0; i &lt; this-&gt;m_NumberOfDimensions; i++)</span>
  {
<span style = "background-color:#fdd">    this-&gt;m_Dimensions[i] = dims[i];
  }
}</span>

mitk::ChannelDescriptor mitk::ImageDescriptor::GetChannelDescriptor(unsigned int id) const
<span style = "background-color:#fdd">{
  return this-&gt;m_ChannelDesc[id];
}</span>

mitk::PixelType mitk::ImageDescriptor::GetChannelTypeByName(const char *name) const
<span style = "background-color:#fdd">{
  unsigned int idFound = 0;
  const std::string search_str(name);</span>

<span style = "background-color:#fdd">  for (auto iter = this-&gt;m_ChannelNames.begin(); iter &lt; this-&gt;m_ChannelNames.end(); iter++)</span>
  {
<span style = "background-color:#fdd">    if (search_str.compare(*iter))
      idFound = iter - this-&gt;m_ChannelNames.begin();
  }</span>

<span style = "background-color:#fdd">  return (m_ChannelDesc[idFound]).GetPixelType();
}</span>

mitk::PixelType mitk::ImageDescriptor::GetChannelTypeById(const unsigned int id) const
<span style = "background-color:#fdd">{
  if (id &gt; this-&gt;m_NumberOfChannels)</span>
  {
<span style = "background-color:#fdd">    throw std::invalid_argument("The given id exceeds the number of active channel.");
  }</span>
  else
  {
<span style = "background-color:#fdd">    mitk::ChannelDescriptor refDesc = this-&gt;m_ChannelDesc[id];
    return refDesc.GetPixelType(); //</span>
  }
<span style = "background-color:#fdd">}</span>

const std::string mitk::ImageDescriptor::GetChannelName(unsigned int id) const
<span style = "background-color:#fdd">{
  if (id &gt; this-&gt;m_ChannelNames.size())
    return "Out-of-range-access";</span>
  else
<span style = "background-color:#fdd">    return this-&gt;m_ChannelNames.at(id);
}</span></pre>
	</body>
</html>