<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>lancetSpatialFittingNavigationToolToSpaceFilter.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
#include "lancetSpatialFittingNavigationToolToSpaceFilter.h"
BEGIN_SPATIAL_FITTING_NAMESPACE

// struct NavigationToolToSpaceFilter::NavigationToolToSpaceFilterPrivateImp
// {
// };
//
// NavigationToolToSpaceFilter::NavigationToolToSpaceFilter()
// 	: imp(std::make_shared&lt;NavigationToolToSpaceFilterPrivateImp&gt;())
// {
// 	
// }

<span style = "background-color:#fdd">NavigationToolToSpaceFilter::NavigationToolToSpaceFilter():mitk::NavigationDataToNavigationDataFilter()
{
	m_RegistrationMatrix = mitk::AffineTransform3D::New();
}</span>

NavigationToolToSpaceFilter::~NavigationToolToSpaceFilter()
<span style = "background-color:#fdd">{
	m_RegistrationMatrix = nullptr;
}</span>


void NavigationToolToSpaceFilter::GenerateData()
<span style = "background-color:#fdd">{
	if (m_RegistrationMatrix.IsNull())</span>
	{
<span style = "background-color:#fdd">		itkExceptionMacro("Invalid parameter: m_RegistrationMatrix NULL.")</span>
	}

<span style = "background-color:#fdd">	DataObjectPointerArraySizeType numberOfInputs = this-&gt;GetNumberOfInputs();</span>

<span style = "background-color:#fdd">	if (numberOfInputs == 0)</span>
	{
<span style = "background-color:#fdd">		return;</span>
	}
		

<span style = "background-color:#fdd">	this-&gt;CreateOutputsForAllInputs();</span>

	// generate output
<span style = "background-color:#fdd">	for (unsigned int i = 0; i &lt; numberOfInputs; ++i)</span>
	{
<span style = "background-color:#fdd">		const mitk::NavigationData* input = this-&gt;GetInput(i);
		assert(input);</span>

<span style = "background-color:#fdd">		mitk::NavigationData* output = this-&gt;GetOutput(i);
		assert(output);</span>

<span style = "background-color:#fdd">		if (input-&gt;IsDataValid() == false)</span>
		{
<span style = "background-color:#fdd">			output-&gt;SetDataValid(false);
			continue;</span>
		}
		//transform nd from move device to reference device coords
<span style = "background-color:#fdd">		mitk::AffineTransform3D::Pointer inputTransform = input-&gt;GetAffineTransform3D();</span>

<span style = "background-color:#fdd">		inputTransform-&gt;Compose(m_RegistrationMatrix);</span>

<span style = "background-color:#fdd">		mitk::NavigationData::Pointer res = mitk::NavigationData::New(inputTransform);</span>

		//copy information to output
<span style = "background-color:#fdd">		output-&gt;Graft(input); // copy all information from input to output
		output-&gt;SetPosition(res-&gt;GetPosition());
		output-&gt;SetOrientation(res-&gt;GetOrientation());</span>
		//output-&gt;SetDataValid(input-&gt;IsDataValid());
<span style = "background-color:#fdd">	}</span>

<span style = "background-color:#fdd">}</span>
END_SPATIAL_FITTING_NAMESPACE
</pre>
	</body>
</html>