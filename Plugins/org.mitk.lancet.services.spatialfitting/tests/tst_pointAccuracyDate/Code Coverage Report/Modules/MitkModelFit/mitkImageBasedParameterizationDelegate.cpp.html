<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkImageBasedParameterizationDelegate.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkImageBasedParameterizationDelegate.h"

#include "mitkImagePixelReadAccessor.h"
#include "mitkPixelTypeMultiplex.h"

mitk::ImageBasedParameterizationDelegate::ImageBasedParameterizationDelegate()
<span style = "background-color:#fdd">{
}</span>

mitk::ImageBasedParameterizationDelegate::~ImageBasedParameterizationDelegate()
<span style = "background-color:#fdd">{
}</span>

mitk::ImageBasedParameterizationDelegate::ParametersType mitk::ImageBasedParameterizationDelegate::GetInitialParameterization() const
<span style = "background-color:#fdd">{
    itk::Index&lt;3&gt; index = {{0, 0, 0}};
    return GetInitialParameterization(index);
}</span>

template &lt;typename TPixel&gt;
static void AccessPixel(mitk::PixelType /*ptype*/, mitk::Image::ConstPointer im, const mitk::ImageBasedParameterizationDelegate::IndexType &amp;currentPosition, mitk::ImageBasedParameterizationDelegate::ParametersType::ValueType &amp;val)
<span style = "background-color:#fdd">{
  mitk::ImagePixelReadAccessor&lt;TPixel, 3&gt; access(im);
  val = access.GetPixelByIndex(currentPosition);
}</span>

mitk::ImageBasedParameterizationDelegate::ParametersType mitk::ImageBasedParameterizationDelegate::GetInitialParameterization(const IndexType &amp;currentPosition) const
<span style = "background-color:#fdd">{
    ParametersType initialParameters = this-&gt;m_Parameterization;</span>

<span style = "background-color:#fdd">    for (const auto&amp; pos : this-&gt;m_ParameterImageMap)</span>
    {
<span style = "background-color:#fdd">      ParametersType::ValueType value = 0.0;
      mitkPixelTypeMultiplex3(AccessPixel, pos.second-&gt;GetChannelDescriptor().GetPixelType(), pos.second, currentPosition, value);</span>

<span style = "background-color:#fdd">      initialParameters[pos.first] = value;
    }</span>

<span style = "background-color:#fdd">    return initialParameters;
}</span>

void
mitk::ImageBasedParameterizationDelegate::AddInitialParameterImage(const mitk::Image* image, ParametersType::size_type paramIndex)
<span style = "background-color:#fdd">{
  if (paramIndex &gt;= this-&gt;m_Parameterization.Size())</span>
  {
<span style = "background-color:#fdd">    mitkThrow() &lt;&lt; "Initial value image is set for invalid parameter index. Number of parameter: " &lt;&lt; this-&gt;m_Parameterization.Size() &lt;&lt; "; invalid index: " &lt;&lt; paramIndex;</span>
  }

<span style = "background-color:#fdd">  m_ParameterImageMap.insert(std::make_pair(paramIndex, image));
};</span></pre>
	</body>
</html>