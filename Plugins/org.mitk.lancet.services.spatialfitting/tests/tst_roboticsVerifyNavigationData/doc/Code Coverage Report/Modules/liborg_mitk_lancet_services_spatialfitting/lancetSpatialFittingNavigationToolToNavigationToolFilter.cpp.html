<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>lancetSpatialFittingNavigationToolToNavigationToolFilter.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
#include "lancetSpatialFittingNavigationToolToNavigationToolFilter.h"

BEGIN_SPATIAL_FITTING_NAMESPACE

// struct NavigationToolToNavigationToolFilter::NavigationToolToNavigationToolFilterPrivateImp
// {
// };

// NavigationToolToNavigationToolFilter::NavigationToolToNavigationToolFilter()
// 	: imp(std::make_shared&lt;NavigationToolToNavigationToolFilterPrivateImp&gt;())
// {
// }

<span style = "background-color:#dfd">NavigationToolToNavigationToolFilter::NavigationToolToNavigationToolFilter() : mitk::NavigationDataToNavigationDataFilter()
{
	m_UCSNavigationData = mitk::NavigationData::New();
}</span>

NavigationToolToNavigationToolFilter::~NavigationToolToNavigationToolFilter()
<span style = "background-color:#dfd">{
	m_UCSNavigationData = nullptr;
}</span>


void NavigationToolToNavigationToolFilter::GenerateData()
<span style = "background-color:#fdd">{
	if (m_UCSNavigationData.IsNull())</span>
	{
<span style = "background-color:#fdd">		itkExceptionMacro("Invalid parameter: m_UCSNavigationData NULL.");
		return;</span>
	}

<span style = "background-color:#fdd">	auto inverseUCSNavigationData = m_UCSNavigationData-&gt;GetInverse();</span>

<span style = "background-color:#fdd">	DataObjectPointerArraySizeType numberOfInputs = this-&gt;GetNumberOfInputs();</span>

<span style = "background-color:#fdd">	if (numberOfInputs == 0)
		return;</span>

<span style = "background-color:#fdd">	this-&gt;CreateOutputsForAllInputs();</span>

	// generate output
<span style = "background-color:#fdd">	for (unsigned int i = 0; i &lt; numberOfInputs; ++i)</span>
	{
<span style = "background-color:#fdd">		const mitk::NavigationData* input = this-&gt;GetInput(i);
		assert(input);</span>

<span style = "background-color:#fdd">		mitk::NavigationData* output = this-&gt;GetOutput(i);
		assert(output);</span>

<span style = "background-color:#fdd">		if (input-&gt;IsDataValid() == false)</span>
		{
<span style = "background-color:#fdd">			output-&gt;SetDataValid(false);
			continue;</span>
		}
		//transform nd from move device to reference device coords
<span style = "background-color:#fdd">		mitk::AffineTransform3D::Pointer inputTransform = input-&gt;GetAffineTransform3D();</span>

<span style = "background-color:#fdd">		inputTransform-&gt;Compose(inverseUCSNavigationData-&gt;GetAffineTransform3D());</span>
		
<span style = "background-color:#fdd">		mitk::NavigationData::Pointer res = mitk::NavigationData::New(inputTransform);</span>

		//copy information to output
<span style = "background-color:#fdd">		output-&gt;Graft(input); // copy all information from input to output
		output-&gt;SetPosition(res-&gt;GetPosition());
		output-&gt;SetOrientation(res-&gt;GetOrientation());</span>
		//output-&gt;SetDataValid(input-&gt;IsDataValid());
<span style = "background-color:#fdd">	}
}</span>

END_SPATIAL_FITTING_NAMESPACE</pre>
	</body>
</html>