<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>vtkMitkRectangleProp.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "vtkMitkRectangleProp.h"

#include &lt;vtkLine.h&gt;
#include &lt;vtkPolyData.h&gt;
#include &lt;vtkPolyDataMapper2D.h&gt;
#include &lt;vtkProperty2D.h&gt;
#include &lt;vtkViewport.h&gt;

<span style = "background-color:#fdd">vtkStandardNewMacro(vtkMitkRectangleProp);</span>

vtkMitkRectangleProp::vtkMitkRectangleProp()
<span style = "background-color:#fdd">  : m_Height(0),
    m_Width(0),
    m_OriginX(0),
    m_OriginY(0),
    m_PolyData(vtkSmartPointer&lt;vtkPolyData&gt;::New())
{
  auto points = vtkSmartPointer&lt;vtkPoints&gt;::New();
  m_PolyData-&gt;SetPoints(points);</span>

<span style = "background-color:#fdd">  auto lines = vtkSmartPointer&lt;vtkCellArray&gt;::New();
  m_PolyData-&gt;SetLines(lines);</span>

<span style = "background-color:#fdd">  auto mapper = vtkSmartPointer&lt;vtkPolyDataMapper2D&gt;::New();</span>

<span style = "background-color:#fdd">  auto transformCoordinate = vtkSmartPointer&lt;vtkCoordinate&gt;::New();
  transformCoordinate-&gt;SetCoordinateSystemToDisplay();
  mapper-&gt;SetTransformCoordinate(transformCoordinate);</span>

<span style = "background-color:#fdd">  this-&gt;CreateRectangle();</span>

<span style = "background-color:#fdd">  mapper-&gt;SetInputData(m_PolyData);
  this-&gt;SetMapper(mapper);</span>

<span style = "background-color:#fdd">  this-&gt;GetProperty()-&gt;SetLineWidth(2);
}</span>

vtkMitkRectangleProp::~vtkMitkRectangleProp()
<span style = "background-color:#fdd">{
}</span>

int vtkMitkRectangleProp::RenderOverlay(vtkViewport *viewport)
<span style = "background-color:#fdd">{
  if (nullptr == this-&gt;Mapper)</span>
  {
<span style = "background-color:#fdd">    vtkErrorMacro(&lt;&lt; "vtkActor2D::Render - No mapper set");
    return 0;</span>
  }

<span style = "background-color:#fdd">  if (!GetVisibility())
    return 0;</span>

<span style = "background-color:#fdd">  if (viewport-&gt;GetSize()[0] != m_Width || viewport-&gt;GetSize()[1] != m_Height)</span>
  {
<span style = "background-color:#fdd">    m_Width = viewport-&gt;GetSize()[0];
    m_Height = viewport-&gt;GetSize()[1];
    m_OriginX = viewport-&gt;GetOrigin()[0];
    m_OriginY = viewport-&gt;GetOrigin()[1];
    this-&gt;UpdateRectangle();</span>
  }

<span style = "background-color:#fdd">  this-&gt;Mapper-&gt;RenderOverlay(viewport, this);
  return 1;
}</span>

void vtkMitkRectangleProp::UpdateRectangle()
<span style = "background-color:#fdd">{
  float offset = this-&gt;GetProperty()-&gt;GetLineWidth() * 0.5f;</span>

<span style = "background-color:#fdd">  auto points = m_PolyData-&gt;GetPoints();
  points-&gt;SetPoint(m_BottomLeft, m_OriginX + offset, m_OriginY + offset, 0.0f);
  points-&gt;SetPoint(m_BottomRight, m_OriginX + m_Width - offset, m_OriginY + offset, 0.0f);
  points-&gt;SetPoint(m_TopRight, m_OriginX + m_Width - offset, m_OriginY + m_Height - offset, 0.0f);
  points-&gt;SetPoint(m_TopLeft, m_OriginX + offset, m_OriginY + m_Height - offset, 0.0f);
}</span>

void vtkMitkRectangleProp::CreateRectangle()
<span style = "background-color:#fdd">{
  auto points = m_PolyData-&gt;GetPoints();
  auto lines = m_PolyData-&gt;GetLines();</span>

<span style = "background-color:#fdd">  m_BottomLeft = points-&gt;InsertNextPoint(0.0f, 0.0f, 0.0f);
  m_BottomRight = points-&gt;InsertNextPoint(1.0f, 0.0f, 0.0f);
  m_TopRight = points-&gt;InsertNextPoint(1.0f, 1.0f, 0.0f);
  m_TopLeft = points-&gt;InsertNextPoint(0.0f, 1.0f, 0.0f);</span>

<span style = "background-color:#fdd">  auto line = vtkSmartPointer&lt;vtkLine&gt;::New();
  line-&gt;GetPointIds()-&gt;SetId(0, m_BottomLeft);
  line-&gt;GetPointIds()-&gt;SetId(1, m_BottomRight);
  lines-&gt;InsertNextCell(line);</span>

<span style = "background-color:#fdd">  line = vtkSmartPointer&lt;vtkLine&gt;::New();
  line-&gt;GetPointIds()-&gt;SetId(0, m_BottomRight);
  line-&gt;GetPointIds()-&gt;SetId(1, m_TopRight);
  lines-&gt;InsertNextCell(line);</span>

<span style = "background-color:#fdd">  line = vtkSmartPointer&lt;vtkLine&gt;::New();
  line-&gt;GetPointIds()-&gt;SetId(0, m_TopRight);
  line-&gt;GetPointIds()-&gt;SetId(1, m_TopLeft);
  lines-&gt;InsertNextCell(line);</span>

<span style = "background-color:#fdd">  line = vtkSmartPointer&lt;vtkLine&gt;::New();
  line-&gt;GetPointIds()-&gt;SetId(0, m_TopLeft);
  line-&gt;GetPointIds()-&gt;SetId(1, m_BottomLeft);
  lines-&gt;InsertNextCell(line);
}</span>

void vtkMitkRectangleProp::SetColor(float red, float green, float blue)
<span style = "background-color:#fdd">{
  this-&gt;GetProperty()-&gt;SetColor(red, green, blue);
}</span>

void vtkMitkRectangleProp::SetLineWidth(unsigned int lineWidth)
<span style = "background-color:#fdd">{
  this-&gt;GetProperty()-&gt;SetLineWidth(lineWidth);
}</span></pre>
	</body>
</html>