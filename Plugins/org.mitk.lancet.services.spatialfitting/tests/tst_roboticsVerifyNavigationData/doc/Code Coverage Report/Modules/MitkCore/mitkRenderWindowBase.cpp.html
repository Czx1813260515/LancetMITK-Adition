<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkRenderWindowBase.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkRenderWindowBase.h"
#include "mitkRenderingManager.h"
#include "mitkVtkLayerController.h"
#include "vtkRenderer.h"

#include "mitkAnnotationUtils.h"

<span style = "background-color:#fdd">mitk::RenderWindowBase::RenderWindowBase() : m_RenderProp(nullptr), m_InResize(false)
{
}</span>

/*
* "Member functions, including virtual functions (10.3), can be called during construction or destruction (12.6.2). When
a
* virtual function is called directly or indirectly from a constructor (including from the mem-initializer for a data
member) or from
* a destructor, and the object to which the call applies is the object under construction or destruction, the function
called is
* the one defined in the constructor or destructor's own class or in one of its bases, but not a function overriding it
in a class
* derived from the constructor or destructor's class, or overriding it in one of the other base classes of the most
derived object[..]"

* or short: within constructors and destructors classes are not polymorph.
*/
void mitk::RenderWindowBase::Initialize(const char *name)
<span style = "background-color:#fdd">{
  auto renderingManager = mitk::RenderingManager::GetInstance();</span>

<span style = "background-color:#fdd">  if (m_Renderer.IsNull())
    m_Renderer = mitk::VtkPropRenderer::New(name, GetVtkRenderWindow());</span>

<span style = "background-color:#fdd">  m_Renderer-&gt;InitRenderer(this-&gt;GetVtkRenderWindow());</span>

<span style = "background-color:#fdd">  mitk::BaseRenderer::AddInstance(GetVtkRenderWindow(), m_Renderer);</span>

<span style = "background-color:#fdd">  renderingManager-&gt;AddRenderWindow(GetVtkRenderWindow());</span>

  // Add previously created overlays to new BaseRenderer
<span style = "background-color:#fdd">  mitk::AnnotationUtils::BaseRendererChanged(m_Renderer);</span>

<span style = "background-color:#fdd">  m_RenderProp = vtkMitkRenderProp::New();
  m_RenderProp-&gt;SetPropRenderer(m_Renderer);
  m_Renderer-&gt;GetVtkRenderer()-&gt;AddViewProp(m_RenderProp);</span>

<span style = "background-color:#fdd">  if ((this-&gt;GetVtkRenderWindow()-&gt;GetSize()[0] &gt; 10) &amp;&amp; (this-&gt;GetVtkRenderWindow()-&gt;GetSize()[1] &gt; 10))
    m_Renderer-&gt;InitSize(this-&gt;GetVtkRenderWindow()-&gt;GetSize()[0], this-&gt;GetVtkRenderWindow()-&gt;GetSize()[1]);</span>

<span style = "background-color:#fdd">  m_InResize = false;
}</span>

bool mitk::RenderWindowBase::HandleEvent(InteractionEvent *interactionEvent)
<span style = "background-color:#fdd">{
  return m_Renderer-&gt;GetDispatcher()-&gt;ProcessEvent(interactionEvent);
}</span>

void mitk::RenderWindowBase::Destroy()
<span style = "background-color:#fdd">{
  RenderingManager::GetInstance()-&gt;RemoveRenderWindow(GetVtkRenderWindow());
  m_Renderer-&gt;GetVtkRenderer()-&gt;RemoveViewProp(m_RenderProp);
  m_RenderProp-&gt;Delete();
  BaseRenderer::RemoveInstance(this-&gt;GetVtkRenderWindow());
}</span>

mitk::RenderWindowBase::~RenderWindowBase()
<span style = "background-color:#fdd">{
}</span>

mitk::SliceNavigationController *mitk::RenderWindowBase::GetSliceNavigationController()
<span style = "background-color:#fdd">{
  return mitk::BaseRenderer::GetInstance(this-&gt;GetVtkRenderWindow())-&gt;GetSliceNavigationController();
}</span>

mitk::CameraRotationController *mitk::RenderWindowBase::GetCameraRotationController()
<span style = "background-color:#fdd">{
  return mitk::BaseRenderer::GetInstance(this-&gt;GetVtkRenderWindow())-&gt;GetCameraRotationController();
}</span>

mitk::BaseController *mitk::RenderWindowBase::GetController()
<span style = "background-color:#fdd">{
  mitk::BaseRenderer *renderer = mitk::BaseRenderer::GetInstance(GetVtkRenderWindow());
  switch (renderer-&gt;GetMapperID())</span>
  {
    case mitk::BaseRenderer::Standard2D:
<span style = "background-color:#fdd">      return GetSliceNavigationController();</span>

    case mitk::BaseRenderer::Standard3D:
<span style = "background-color:#fdd">      return GetCameraRotationController();</span>

    default:
<span style = "background-color:#fdd">      return GetSliceNavigationController();</span>
  }
<span style = "background-color:#fdd">}</span>

mitk::VtkPropRenderer *mitk::RenderWindowBase::GetRenderer()
<span style = "background-color:#fdd">{
  return m_Renderer;
}</span></pre>
	</body>
</html>