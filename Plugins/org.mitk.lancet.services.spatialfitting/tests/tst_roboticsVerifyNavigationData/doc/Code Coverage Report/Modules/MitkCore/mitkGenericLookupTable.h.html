<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkGenericLookupTable.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#ifndef MITKGENERICLOOKUPTABLE_H_HEADER_INCLUDED_C1061CEE
#define MITKGENERICLOOKUPTABLE_H_HEADER_INCLUDED_C1061CEE

#include &lt;map&gt;
#include &lt;sstream&gt;
#include &lt;cstdlib&gt;
#include &lt;string&gt;

#include &lt;itkDataObject.h&gt;

#include "mitkNumericTypes.h"
#include &lt;MitkCoreExports.h&gt;

namespace mitk
{
  /**
   * @brief Template class for generating lookup-tables
   *
   * This class template can be instantiated for all classes/internal types that fulfills
   *  these requirements:
   * - an operator&lt;&lt; so that the properties value can be put into a std::stringstream
   * - an operator== so that two properties can be checked for equality
   *
   * The main purpose of this class is to be used in conjunction with
   * GenericLookupTableProperty. This enables passing of arbitrary lookup
   * tables to mappers to configure the rendering process.
   */
  template &lt;typename T&gt;
  class GenericLookupTable
  {
  public:
    typedef unsigned int IdentifierType;
    typedef T ValueType;
    typedef std::map&lt;IdentifierType, ValueType&gt; LookupTableType;

    typedef GenericLookupTable Self;

<span style = "background-color:#fdd">    GenericLookupTable() {}
    virtual ~GenericLookupTable() {}
    virtual const char *GetNameOfClass() const { return "GenericLookupTable"; }
    void SetTableValue(IdentifierType id, ValueType value) { m_LookupTable[id] = value; }</span>
    bool ValueExists(IdentifierType id) const
<span style = "background-color:#fdd">    {
      auto it = m_LookupTable.find(id);
      return (it != m_LookupTable.end());
    }</span>

    ValueType GetTableValue(IdentifierType id) const
<span style = "background-color:#fdd">    {
      auto it = m_LookupTable.find(id);
      if (it != m_LookupTable.end())
        return it-&gt;second;</span>
      else
<span style = "background-color:#fdd">        throw std::range_error("id does not exist in the lookup table");
    }</span>

<span style = "background-color:#fdd">    const LookupTableType &amp;GetLookupTable() const { return m_LookupTable; }
    bool operator==(const Self &amp;lookupTable) const { return (m_LookupTable == lookupTable.m_LookupTable); }
    bool operator!=(const Self &amp;lookupTable) const { return !(m_LookupTable == lookupTable.m_LookupTable); }</span>
    virtual Self &amp;operator=(const Self &amp;other) // \TODO: this needs to be unit tested!
<span style = "background-color:#fdd">    {
      if (this == &amp;other)</span>
      {
<span style = "background-color:#fdd">        return *this;
      }</span>
      else
      {
<span style = "background-color:#fdd">        m_LookupTable.clear();
        m_LookupTable = other.m_LookupTable;
        return *this;</span>
      }
<span style = "background-color:#fdd">    }</span>

  protected:
    LookupTableType m_LookupTable;
  };
} // namespace mitk

/**
* Generates a specialized subclass of mitk::GenericLookupTable.
* This way, GetNameOfClass() returns the value provided by LookupTableName.
* Please see mitkProperties.h for examples.
* @param LookupTableName the name of the instantiation of GenericLookupTable
* @param Type the value type of the GenericLookupTable
*/
#define mitkSpecializeGenericLookupTable(LookupTableName, Type)                                                        \
                                                                                                                       \
  class MITKCORE_EXPORT LookupTableName : public GenericLookupTable&lt;Type&gt;                                              \
                                                                                                                       \
  {                                                                                                                    \
  public:                                                                                                              \
    typedef LookupTableName Self;                                                                                      \
    typedef GenericLookupTable&lt;Type&gt; Superclass;                                                                       \
    virtual const char *GetNameOfClass() const { return #LookupTableName; }                                            \
    LookupTableName() {}                                                                                               \
    virtual Superclass &amp;operator=(const Superclass &amp;other) { return Superclass::operator=(other); }                    \
    virtual ~LookupTableName() {}                                                                                      \
  };                                                                                                                   \
                                                                                                                       \
  MITKCORE_EXPORT std::ostream &amp;operator&lt;&lt;(std::ostream &amp;stream, const LookupTableName &amp; /*l*/);

/**
* Generates the ostream &lt;&lt; operator for the lookuptable. This definition
* of a global function must be in a cpp file, therefore it is split from the
* class declaration macro mitkSpecializeGenericLookupTable.
*/
#define mitkSpecializeGenericLookupTableOperator(LookupTableName)                                                      \
                                                                                                                       \
  std::ostream &amp;mitk::operator&lt;&lt;(std::ostream &amp;stream, const LookupTableName &amp;l)                                       \
                                                                                                                       \
  {                                                                                                                    \
    typedef LookupTableName::LookupTableType::const_iterator IterType;                                                 \
    IterType e = l.GetLookupTable().end();                                                                             \
    IterType b = l.GetLookupTable().begin();                                                                           \
    stream &lt;&lt; "[";                                                                                                     \
    for (IterType i = b; i != e; ++i)                                                                                  \
    {                                                                                                                  \
      if (i != b)                                                                                                      \
      {                                                                                                                \
        stream &lt;&lt; ", ";                                                                                                \
      }                                                                                                                \
      stream &lt;&lt; i-&gt;first &lt;&lt; " -&gt; " &lt;&lt; i-&gt;second;                                                                       \
    }                                                                                                                  \
    return stream &lt;&lt; "]";                                                                                              \
  };
#endif</pre>
	</body>
</html>