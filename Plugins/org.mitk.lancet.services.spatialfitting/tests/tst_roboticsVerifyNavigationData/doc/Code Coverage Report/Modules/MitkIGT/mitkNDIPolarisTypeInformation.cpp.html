<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkNDIPolarisTypeInformation.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkNDIPolarisTypeInformation.h"

#include "mitkNDITrackingDevice.h"

namespace mitk
{
  std::string NDIPolarisTypeInformation::GetTrackingDeviceName()
<span style = "background-color:#dfd">  {
    return "NDI Polaris"; ///&lt; Polaris: optical Tracker from NDI;
  }</span>
  TrackingDeviceData NDIPolarisTypeInformation::GetDeviceDataPolarisOldModel()
<span style = "background-color:#dfd">  {
    TrackingDeviceData data = { NDIPolarisTypeInformation::GetTrackingDeviceName(), "Polaris (Old Model)", "NDIPolarisOldModel.stl", "0" };
    return data;
  }</span>
  TrackingDeviceData NDIPolarisTypeInformation::GetDeviceDataPolarisSpectra()
<span style = "background-color:#dfd">  {</span>
    //full hardware code of polaris spectra: 5-240000-153200-095000+057200+039800+056946+024303+029773+999999+99999924
<span style = "background-color:#dfd">    TrackingDeviceData data = { NDIPolarisTypeInformation::GetTrackingDeviceName(), "Polaris Spectra", "NDIPolarisSpectra.stl", "5-2" };
    return data;
  }</span>

  TrackingDeviceData NDIPolarisTypeInformation::GetDeviceDataSpectraExtendedPyramid()
<span style = "background-color:#dfd">  {</span>
    //full hardware code of polaris spectra (extended pyramid): 5-300000-153200-095000+057200+039800+056946+024303+029773+999999+07350024
<span style = "background-color:#dfd">    TrackingDeviceData data = { NDIPolarisTypeInformation::GetTrackingDeviceName(), "Polaris Spectra (Extended Pyramid)", "NDIPolarisSpectraExtendedPyramid.stl", "5-3" };
    return data;
  }</span>
  TrackingDeviceData NDIPolarisTypeInformation::GetDeviceDataPolarisVicra()
<span style = "background-color:#dfd">  {
    TrackingDeviceData data = { NDIPolarisTypeInformation::GetTrackingDeviceName(), "Polaris Vicra", "NDIPolarisVicra.stl", "7" };
    return data;
  }</span>

  NDIPolarisTypeInformation::NDIPolarisTypeInformation()
<span style = "background-color:#dfd">  {
    m_DeviceName = NDIPolarisTypeInformation::GetTrackingDeviceName();
    m_TrackingDeviceData.push_back(GetDeviceDataPolarisOldModel());
    m_TrackingDeviceData.push_back(GetDeviceDataSpectraExtendedPyramid());
    m_TrackingDeviceData.push_back(GetDeviceDataPolarisSpectra());
    m_TrackingDeviceData.push_back(GetDeviceDataPolarisVicra());
  }</span>

  NDIPolarisTypeInformation::~NDIPolarisTypeInformation()
<span style = "background-color:#dfd">  {
  }</span>

  mitk::TrackingDeviceSource::Pointer NDIPolarisTypeInformation::CreateTrackingDeviceSource(
    mitk::TrackingDevice::Pointer trackingDevice,
    mitk::NavigationToolStorage::Pointer navigationTools,
    std::string* errorMessage,
    std::vector&lt;int&gt;* toolCorrespondencesInToolStorage)
<span style = "background-color:#fdd">  {
    mitk::TrackingDeviceSource::Pointer returnValue = mitk::TrackingDeviceSource::New();
    mitk::NDITrackingDevice::Pointer thisDevice = dynamic_cast&lt;mitk::NDITrackingDevice*&gt;(trackingDevice.GetPointer());
    *toolCorrespondencesInToolStorage = std::vector&lt;int&gt;();</span>
    //add the tools to the tracking device
<span style = "background-color:#fdd">    for (unsigned int i = 0; i &lt; navigationTools-&gt;GetToolCount(); i++)</span>
    {
<span style = "background-color:#fdd">      mitk::NavigationTool::Pointer thisNavigationTool = navigationTools-&gt;GetTool(i);
      toolCorrespondencesInToolStorage-&gt;push_back(i);
      bool toolAddSuccess = thisDevice-&gt;AddTool(thisNavigationTool-&gt;GetToolName().c_str(), thisNavigationTool-&gt;GetCalibrationFile().c_str());
      if (!toolAddSuccess)</span>
      {
        //todo: error handling
<span style = "background-color:#fdd">        errorMessage-&gt;append("Can't add tool, is the SROM-file valid?");
        return nullptr;</span>
      }
<span style = "background-color:#fdd">      thisDevice-&gt;GetTool(i)-&gt;SetToolTipPosition(thisNavigationTool-&gt;GetToolTipPosition(), thisNavigationTool-&gt;GetToolAxisOrientation());
    }
    returnValue-&gt;SetTrackingDevice(thisDevice);
    return returnValue;
  }</span>
}</pre>
	</body>
</html>