<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkVtkLogoRepresentation.cxx</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkVtkLogoRepresentation.h"
#include "vtkActor2D.h"
#include "vtkCallbackCommand.h"
#include "vtkCellArray.h"
#include "vtkFloatArray.h"
#include "vtkImageData.h"
#include "vtkObjectFactory.h"
#include "vtkPointData.h"
#include "vtkPoints.h"
#include "vtkPolyData.h"
#include "vtkPolyData.h"
#include "vtkPolyDataMapper2D.h"
#include "vtkPolyDataMapper2D.h"
#include "vtkPropCollection.h"
#include "vtkProperty2D.h"
#include "vtkRenderer.h"
#include "vtkTexture.h"
#include "vtkWindow.h"

<span style = "background-color:#fdd">vtkStandardNewMacro(mitkVtkLogoRepresentation);</span>

//----------------------------------------------------------------------
inline void mitkVtkLogoRepresentation::AdjustImageSize(double /*o*/[2], double borderSize[2], double imageSize[2])
<span style = "background-color:#fdd">{</span>
  // Scale the image to fit with in the border.
  // Also update the origin so the image is centered.
<span style = "background-color:#fdd">  double r0 = borderSize[0] / imageSize[0];
  double r1 = borderSize[1] / imageSize[1];
  if (r0 &gt; r1)</span>
  {
<span style = "background-color:#fdd">    imageSize[0] *= r1;
    imageSize[1] *= r1;
  }</span>
  else
  {
<span style = "background-color:#fdd">    imageSize[0] *= r0;
    imageSize[1] *= r0;</span>
  }
<span style = "background-color:#fdd">}</span>

//-------------------------------------------------------------------------
void mitkVtkLogoRepresentation::BuildRepresentation()
<span style = "background-color:#fdd">{
  if (this-&gt;GetMTime() &gt; this-&gt;BuildTime || (this-&gt;Renderer &amp;&amp; this-&gt;Renderer-&gt;GetVTKWindow() &amp;&amp;</span>
                                             this-&gt;Renderer-&gt;GetVTKWindow()-&gt;GetMTime() &gt; this-&gt;BuildTime))
  {
    // Determine and adjust the size of the image
<span style = "background-color:#fdd">    if (this-&gt;Image)</span>
    {
      double imageSize[2], borderSize[2], o[2];
<span style = "background-color:#fdd">      imageSize[0] = 0.0;
      imageSize[1] = 0.0;</span>
      // this-&gt;Image-&gt;Update();
<span style = "background-color:#fdd">      if (this-&gt;Image-&gt;GetDataDimension() == 2)</span>
      {
        int dims[3];
<span style = "background-color:#fdd">        this-&gt;Image-&gt;GetDimensions(dims);
        imageSize[0] = static_cast&lt;double&gt;(dims[0]);
        imageSize[1] = static_cast&lt;double&gt;(dims[1]);</span>
      }
<span style = "background-color:#fdd">      int *p1 = this-&gt;PositionCoordinate-&gt;GetComputedDisplayValue(this-&gt;Renderer);
      int *p2 = this-&gt;Position2Coordinate-&gt;GetComputedDisplayValue(this-&gt;Renderer);
      borderSize[0] = p2[0];
      borderSize[1] = p2[1];
      o[0] = static_cast&lt;double&gt;(p1[0]);
      o[1] = static_cast&lt;double&gt;(p1[1]);</span>

      // this preserves the image aspect ratio. The image is
      // centered around the center of the bordered ragion.
<span style = "background-color:#fdd">      this-&gt;AdjustImageSize(o, borderSize, imageSize);</span>

      // Update the points
<span style = "background-color:#fdd">      this-&gt;Texture-&gt;SetInputData(this-&gt;Image);
      int *size = this-&gt;Renderer-&gt;GetSize();</span>

<span style = "background-color:#fdd">      switch (this-&gt;cornerPosition)</span>
      {
        case 0:
        {
<span style = "background-color:#fdd">          this-&gt;TexturePoints-&gt;SetPoint(0, o[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0] + imageSize[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0] + imageSize[0], o[1] + imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0], o[1] + imageSize[1], 0.0);
          break;</span>
        }
        case 1:
        {
<span style = "background-color:#fdd">          o[0] = size[0] - o[0];
          this-&gt;TexturePoints-&gt;SetPoint(0, o[0] - imageSize[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0], o[1] + imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0] - imageSize[0], o[1] + imageSize[1], 0.0);
          break;</span>
        }
        case 2:
        {
<span style = "background-color:#fdd">          o[0] = size[0] - o[0];
          o[1] = size[1] - o[1];
          this-&gt;TexturePoints-&gt;SetPoint(0, o[0] - imageSize[0], o[1] - imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0], o[1] - imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0] - imageSize[0], o[1], 0.0);
          break;</span>
        }
        case 3:
        {
<span style = "background-color:#fdd">          o[1] = size[1] - o[1];
          this-&gt;TexturePoints-&gt;SetPoint(0, o[0], o[1] - imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0] + imageSize[0], o[1] - imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0] + imageSize[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0], o[1], 0.0);
          break;</span>
        }
        case 4:
        {
          double ish[2];
          // ish = middle of the image
<span style = "background-color:#fdd">          ish[0] = imageSize[0] / 2.0;
          ish[1] = imageSize[1] / 2.0;</span>
          // o = middle of the window
<span style = "background-color:#fdd">          o[0] = (size[0]) / 2.0;
          o[1] = (size[1]) / 2.0;
          this-&gt;TexturePoints-&gt;SetPoint(0, o[0] - ish[0], o[1] - ish[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0] + ish[0], o[1] - ish[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0] + ish[0], o[1] + ish[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0] - ish[0], o[1] + ish[1], 0.0);
          break;</span>
        }
        default:
        {
<span style = "background-color:#fdd">          this-&gt;TexturePoints-&gt;SetPoint(0, o[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(1, o[0] + imageSize[0], o[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(2, o[0] + imageSize[0], o[1] + imageSize[1], 0.0);
          this-&gt;TexturePoints-&gt;SetPoint(3, o[0], o[1] + imageSize[1], 0.0);</span>
        }
      }
    }
  }
<span style = "background-color:#fdd">  this-&gt;TexturePoints-&gt;Modified();
}</span>

<span style = "background-color:#fdd">mitkVtkLogoRepresentation::mitkVtkLogoRepresentation() : cornerPosition(0)
{
}</span>

mitkVtkLogoRepresentation::~mitkVtkLogoRepresentation()
<span style = "background-color:#fdd">{
}</span>

//-------------------------------------------------------------------------
void mitkVtkLogoRepresentation::PrintSelf(ostream &amp;os, vtkIndent indent)
<span style = "background-color:#fdd">{
  this-&gt;Superclass::PrintSelf(os, indent);</span>

<span style = "background-color:#fdd">  if (this-&gt;Image)</span>
  {
<span style = "background-color:#fdd">    os &lt;&lt; indent &lt;&lt; "Image:\n";
    this-&gt;Image-&gt;PrintSelf(os, indent.GetNextIndent());
  }</span>
  else
  {
<span style = "background-color:#fdd">    os &lt;&lt; indent &lt;&lt; "Image: (none)\n";</span>
  }

<span style = "background-color:#fdd">  if (this-&gt;ImageProperty)</span>
  {
<span style = "background-color:#fdd">    os &lt;&lt; indent &lt;&lt; "Image Property:\n";
    this-&gt;ImageProperty-&gt;PrintSelf(os, indent.GetNextIndent());
  }</span>
  else
  {
<span style = "background-color:#fdd">    os &lt;&lt; indent &lt;&lt; "Image Property: (none)\n";</span>
  }
<span style = "background-color:#fdd">}</span></pre>
	</body>
</html>