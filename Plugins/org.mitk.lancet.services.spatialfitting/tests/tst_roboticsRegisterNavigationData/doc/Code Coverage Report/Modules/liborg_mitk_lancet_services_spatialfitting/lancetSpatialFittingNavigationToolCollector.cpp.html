<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>lancetSpatialFittingNavigationToolCollector.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
#include "lancetSpatialFittingNavigationToolCollector.h"

// Qt
#include &lt;QTimer&gt;


BEGIN_SPATIAL_FITTING_NAMESPACE

struct NavigationToolCollector::NavigationToolCollectorPrivateImp
{
	QTimer qtClockTrigger;
	unsigned int numberForMean = 10;
	double accuracyRange = 0.5;
	WorkStatus state = WorkStatus::Idle;
	std::string permissionIdentificationArea;

	std::vector&lt;mitk::NavigationData::Pointer&gt; vecCollectorNavigationData;
};

NavigationToolCollector::NavigationToolCollector()
<span style = "background-color:#dfd">	: imp(std::make_shared&lt;NavigationToolCollectorPrivateImp&gt;())
{
	this-&gt;SetInterval(20);</span>

<span style = "background-color:#dfd">	connect(&amp;this-&gt;imp-&gt;qtClockTrigger, &amp;QTimer::timeout, </span>
		this, &amp;NavigationToolCollector::on_QtTimerTrigger_timeout);
<span style = "background-color:#dfd">}</span>

NavigationToolCollector::~NavigationToolCollector()
<span style = "background-color:#dfd">{
	disconnect(&amp;this-&gt;imp-&gt;qtClockTrigger, &amp;QTimer::timeout,</span>
		this, &amp;NavigationToolCollector::on_QtTimerTrigger_timeout);
<span style = "background-color:#dfd">}</span>

long NavigationToolCollector::GetInterval() const
<span style = "background-color:#fdd">{
	return this-&gt;imp-&gt;qtClockTrigger.interval();
}</span>

void NavigationToolCollector::SetInterval(long interval)
<span style = "background-color:#dfd">{
}</span>

unsigned int NavigationToolCollector::GetNumberForMean() const
<span style = "background-color:#fdd">{
	return 0;
}</span>

void NavigationToolCollector::SetNumberForMean(unsigned int number)
<span style = "background-color:#dfd">{
}</span>

double NavigationToolCollector::GetAccuracyRange() const
<span style = "background-color:#fdd">{
	return 0.0;
}</span>

void NavigationToolCollector::SetAccuracyRange(double accuracy)
<span style = "background-color:#dfd">{
}</span>

NavigationToolCollector::WorkStatus NavigationToolCollector::GetWorkState() const
<span style = "background-color:#fdd">{
	return this-&gt;imp-&gt;state;
}</span>

bool NavigationToolCollector::IsRunning() const
<span style = "background-color:#fdd">{
	return this-&gt;GetWorkState() == WorkStatus::Working;
}</span>

bool NavigationToolCollector::Start(long interval)
<span style = "background-color:#fdd">{
	if (this-&gt;GetWorkState() != WorkStatus::Idle)</span>
	{
		// The collector is currently working.
<span style = "background-color:#fdd">		return false;</span>
	}

<span style = "background-color:#fdd">	if (interval != 0)</span>
	{
<span style = "background-color:#fdd">		this-&gt;SetInterval(interval);</span>
	}
<span style = "background-color:#fdd">	this-&gt;imp-&gt;vecCollectorNavigationData.clear();
	this-&gt;imp-&gt;qtClockTrigger.start();
	this-&gt;imp-&gt;state = WorkStatus::Working;
	return true;
}</span>

bool NavigationToolCollector::Stop()
<span style = "background-color:#fdd">{
	this-&gt;imp-&gt;state = WorkStatus::Idle;
	this-&gt;imp-&gt;qtClockTrigger.stop();
	return true;
}</span>

std::string NavigationToolCollector::GetPermissionIdentificationArea() const
<span style = "background-color:#fdd">{
	return this-&gt;imp-&gt;permissionIdentificationArea;
}</span>

void NavigationToolCollector::SetPermissionIdentificationArea(const std::string&amp; area)
<span style = "background-color:#fdd">{
	this-&gt;imp-&gt;permissionIdentificationArea = area;
}</span>

void NavigationToolCollector::on_QtTimerTrigger_timeout()
<span style = "background-color:#fdd">{
	if (this-&gt;GetOutput())</span>
	{
<span style = "background-color:#fdd">		this-&gt;imp-&gt;vecCollectorNavigationData.push_back(this-&gt;GetOutput()-&gt;Clone());
		emit this-&gt;Step(this-&gt;imp-&gt;vecCollectorNavigationData.size(),</span>
			this-&gt;imp-&gt;vecCollectorNavigationData.back().GetPointer());
	}

<span style = "background-color:#fdd">	if (this-&gt;imp-&gt;vecCollectorNavigationData.size() &gt;= this-&gt;GetNumberForMean())</span>
	{
<span style = "background-color:#fdd">		this-&gt;Stop();
		emit this-&gt;Complete(nullptr);</span>
	}
<span style = "background-color:#fdd">}</span>

void NavigationToolCollector::GenerateData()
<span style = "background-color:#fdd">{
	std::cout &lt;&lt; __FUNCTION__ &lt;&lt; "log" &lt;&lt; std::endl;
	this-&gt;CreateOutputsForAllInputs();</span>

<span style = "background-color:#fdd">	for (size_t index = 0; index &lt; this-&gt;GetNumberOfInputs(); ++index)</span>
	{
<span style = "background-color:#fdd">		if (this-&gt;GetInput(index) &amp;&amp; this-&gt;GetOutput(index))</span>
		{
<span style = "background-color:#fdd">			this-&gt;GetOutput(index)-&gt;Graft(this-&gt;GetInput(index));</span>
		}
<span style = "background-color:#fdd">	}
}</span>


END_SPATIAL_FITTING_NAMESPACE</pre>
	</body>
</html>