<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkNavigationDataSetWriterCSV.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkNavigationDataSetWriterCSV.h"
#include &lt;fstream&gt;
#include &lt;mitkIGTMimeTypes.h&gt;
#include &lt;mitkLocaleSwitch.h&gt;

<span style = "background-color:#dfd">mitk::NavigationDataSetWriterCSV::NavigationDataSetWriterCSV() : AbstractFileWriter(NavigationDataSet::GetStaticNameOfClass(),</span>
  mitk::IGTMimeTypes::NAVIGATIONDATASETCSV_MIMETYPE(),
  "MITK NavigationDataSet Reader (CSV)")
<span style = "background-color:#dfd">{
  RegisterService();
}</span>

mitk::NavigationDataSetWriterCSV::~NavigationDataSetWriterCSV()
<span style = "background-color:#dfd">{}</span>

<span style = "background-color:#fdd">mitk::NavigationDataSetWriterCSV::NavigationDataSetWriterCSV(const mitk::NavigationDataSetWriterCSV&amp; other) : AbstractFileWriter(other)
{
}</span>

mitk::NavigationDataSetWriterCSV* mitk::NavigationDataSetWriterCSV::Clone() const
<span style = "background-color:#fdd">{
  return new NavigationDataSetWriterCSV(*this);
}</span>

void mitk::NavigationDataSetWriterCSV::Write()
<span style = "background-color:#fdd">{
  std::ostream* out = GetOutputStream();
  if (out == nullptr)</span>
  {
<span style = "background-color:#fdd">    out = new std::ofstream(GetOutputLocation().c_str());</span>
  }
<span style = "background-color:#fdd">  mitk::NavigationDataSet::ConstPointer data = dynamic_cast&lt;const NavigationDataSet*&gt; (this-&gt;GetInput());</span>

  //define own locale
<span style = "background-color:#fdd">  mitk::LocaleSwitch localeSwitch("C");</span>

  //write header
<span style = "background-color:#fdd">  unsigned int numberOfTools = data-&gt;GetNumberOfTools();
  for (unsigned int index = 0; index &lt; numberOfTools; index++){ *out &lt;&lt; "TimeStamp_Tool" &lt;&lt; index &lt;&lt;</span>
                                                                           ";Valid_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";X_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";Y_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";Z_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";QX_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";QY_Tool" &lt;&lt; index &lt;&lt;
                                                                           ";QZ_Tool" &lt;&lt; index &lt;&lt;
<span style = "background-color:#fdd">                                                                           ";QR_Tool" &lt;&lt; index &lt;&lt; ";";}
  *out &lt;&lt; "\n";</span>

<span style = "background-color:#fdd">  out-&gt;precision(15); // rounding precision because we don't want to loose data.</span>

  //write data
<span style = "background-color:#fdd">  MITK_INFO &lt;&lt; "Number of timesteps: " &lt;&lt; data-&gt;Size();
  for (unsigned int i=0; i&lt;data-&gt;Size(); i++)</span>
  {
<span style = "background-color:#fdd">    std::vector&lt; mitk::NavigationData::Pointer &gt; NavigationDatasOfCurrentStep = data-&gt;GetTimeStep(i);
    for (unsigned int toolIndex = 0; toolIndex &lt; numberOfTools; toolIndex++)</span>
    {
<span style = "background-color:#fdd">      mitk::NavigationData::Pointer nd = NavigationDatasOfCurrentStep.at(toolIndex);
      *out &lt;&lt; nd-&gt;GetIGTTimeStamp() &lt;&lt; ";"</span>
                       &lt;&lt; nd-&gt;IsDataValid() &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetPosition()[0] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetPosition()[1] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetPosition()[2] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetOrientation()[0] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetOrientation()[1] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetOrientation()[2] &lt;&lt; ";"
                       &lt;&lt; nd-&gt;GetOrientation()[3] &lt;&lt; ";";
<span style = "background-color:#fdd">    }
    *out &lt;&lt; "\n";
  }</span>

<span style = "background-color:#fdd">  out-&gt;flush();
  delete out;
}</span></pre>
	</body>
</html>