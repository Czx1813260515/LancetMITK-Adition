<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkMAPAlgorithmHelper.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/


#ifndef mitkMAPAlgorithmHelper_h
#define mitkMAPAlgorithmHelper_h


//MatchPoint
#include "mapRegistrationAlgorithmBase.h"
#include "mapRegistrationBase.h"

//MITK
#include &lt;mitkImage.h&gt;
#include &lt;mitkPointSet.h&gt;

//MITK
#include "MitkMatchPointRegistrationExports.h"
#include "mitkMAPRegistrationWrapper.h"

namespace mitk
{
  /*!
    \brief MAPAlgorithmHelper
    \remark Current implementation is not thread-save. Just use one Helper class per registration task.
    \warning  This class is not yet documented. Use "git blame" and ask the author to provide basic documentation.
  */
  class MITKMATCHPOINTREGISTRATION_EXPORT MAPAlgorithmHelper
  {
  public:

    MAPAlgorithmHelper(map::algorithm::RegistrationAlgorithmBase* algorithm);

    void SetData(const mitk::BaseData* moving, const mitk::BaseData* target);

    void SetAllowImageCasting(bool allowCasting);
    bool GetAllowImageCasting() const;

    static bool HasImageAlgorithmInterface(const map::algorithm::RegistrationAlgorithmBase* algorithm);
    static bool HasPointSetAlgorithmInterface(const map::algorithm::RegistrationAlgorithmBase* algorithm);


    struct CheckError
    {
      enum Type
      {
        none = 0,
        onlyByCasting = 1,
        wrongDimension = 2,
        unsupportedDataType = 3
      };
    };

    bool CheckData(const mitk::BaseData* moving, const mitk::BaseData* target,
                   CheckError::Type&amp; error) const;

    map::core::RegistrationBase::Pointer GetRegistration() const;

    mitk::MAPRegistrationWrapper::Pointer GetMITKRegistrationWrapper() const;

<span style = "background-color:#fdd">    ~MAPAlgorithmHelper() {}</span>

  private:

    MAPAlgorithmHelper&amp; operator = (const MAPAlgorithmHelper&amp;);
    MAPAlgorithmHelper(const MAPAlgorithmHelper&amp;);

    /**Internal helper that casts itk images from one pixel type into an other
      (used by DoSetImages if the images have the right dimension but wrong type and AllowImageCasting is activated)*/
    template&lt;typename TInImageType, typename TOutImageType&gt;
    typename TOutImageType::Pointer CastImage(const TInImageType* input) const;

    /**Internal helper that is used by SetData if the data are images to set them properly.*/
    template&lt;typename TPixelType1, unsigned int VImageDimension1,
             typename TPixelType2, unsigned int VImageDimension2&gt;
    void DoSetImages(const itk::Image&lt;TPixelType1, VImageDimension1&gt;* moving,
                     const itk::Image&lt;TPixelType2, VImageDimension2&gt;* target);

    /**Internal helper that is used by SetData if the data are images to check if the image types are supported by the algorithm.*/
    template&lt;typename TPixelType1, unsigned int VImageDimension1,
             typename TPixelType2, unsigned int VImageDimension2&gt;
    void DoCheckImages(const itk::Image&lt;TPixelType1, VImageDimension1&gt;* moving,
                       const itk::Image&lt;TPixelType2, VImageDimension2&gt;* target) const;

    map::algorithm::RegistrationAlgorithmBase::Pointer m_AlgorithmBase;

    bool m_AllowImageCasting;

    mutable CheckError::Type m_Error;
  };

  /**Small helper function that generates Identity transforms in 3D.*/
  mitk::MAPRegistrationWrapper::Pointer MITKMATCHPOINTREGISTRATION_EXPORT GenerateIdentityRegistration3D();

}

#endif
</pre>
	</body>
</html>