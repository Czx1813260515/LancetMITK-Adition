<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkTimeHelper.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#ifndef MITKTIMEHELPER_H_HEADER_INCLUDED_C1C2FCD2
#define MITKTIMEHELPER_H_HEADER_INCLUDED_C1C2FCD2

#include &lt;mitkTimeGeometry.h&gt;

namespace mitk
{
  //## @brief convert the start- and end-index-time of output-region in
  //## start- and end-index-time of input-region via millisecond-time
  template &lt;class TOutputRegion, class TInputRegion&gt;
  void GenerateTimeInInputRegion(const mitk::TimeGeometry *outputTimeGeometry,
                                 const TOutputRegion &amp;outputRegion,
                                 const mitk::TimeGeometry *inputTimeGeometry,
                                 TInputRegion &amp;inputRegion)
<span style = "background-color:#fdd">  {
    assert(outputTimeGeometry != nullptr);
    assert(inputTimeGeometry != nullptr);</span>

    // convert the start-index-time of output in start-index-time of input via millisecond-time
<span style = "background-color:#fdd">    mitk::TimePointType timeInMS = outputTimeGeometry-&gt;TimeStepToTimePoint(outputRegion.GetIndex(3));
    mitk::TimeStepType timestep = inputTimeGeometry-&gt;TimePointToTimeStep(timeInMS);
    if ((timeInMS &gt; itk::NumericTraits&lt;mitk::ScalarType&gt;::NonpositiveMin()) &amp;&amp;</span>
        (inputTimeGeometry-&gt;IsValidTimeStep(timestep)))
<span style = "background-color:#fdd">      inputRegion.SetIndex(3, timestep);</span>
    else
<span style = "background-color:#fdd">      inputRegion.SetIndex(3, 0);</span>
    // convert the end-index-time of output in end-index-time of input via millisecond-time
<span style = "background-color:#fdd">    timeInMS = outputTimeGeometry-&gt;TimeStepToTimePoint(outputRegion.GetIndex(3) + outputRegion.GetSize(3) - 1);
    timestep = inputTimeGeometry-&gt;TimePointToTimeStep(timeInMS);
    if ((timeInMS &gt; itk::NumericTraits&lt;mitk::ScalarType&gt;::NonpositiveMin()) &amp;&amp;</span>
        (outputTimeGeometry-&gt;IsValidTimeStep(timestep)))
<span style = "background-color:#fdd">      inputRegion.SetSize(3, timestep - inputRegion.GetIndex(3) + 1);</span>
    else
<span style = "background-color:#fdd">      inputRegion.SetSize(3, 1);
  }</span>

  //##Documentation
  //## @brief convert the start- and end-index-time of output in
  //## start- and end-index-time of input1 and input2 via millisecond-time
  template &lt;class TOutputData, class TInputData&gt;
  void GenerateTimeInInputRegion(const TOutputData *output, TInputData *input)
<span style = "background-color:#fdd">  {
    assert(output != nullptr);
    assert(input != nullptr);</span>

<span style = "background-color:#fdd">    const typename TOutputData::RegionType &amp;outputRegion = output-&gt;GetRequestedRegion();
    typename TInputData::RegionType inputRegion;</span>

<span style = "background-color:#fdd">    if (outputRegion.GetSize(3) &lt; 1)</span>
    {
      typename TInputData::RegionType::SizeType inputsize;
<span style = "background-color:#fdd">      inputsize.Fill(0);
      inputRegion.SetSize(inputsize);
      input-&gt;SetRequestedRegion(&amp;inputRegion);</span>
    }

    // convert the start-index-time of output in start-index-time of input via millisecond-time
<span style = "background-color:#fdd">    inputRegion = input-&gt;GetRequestedRegion();
    GenerateTimeInInputRegion(output-&gt;GetTimeGeometry(), outputRegion, input-&gt;GetTimeGeometry(), inputRegion);
    input-&gt;SetRequestedRegion(&amp;inputRegion);
  }</span>

} // end namespace mitk

#endif // MITKTIMEHELPER_H_HEADER_INCLUDED_C1C2FCD2</pre>
	</body>
</html>