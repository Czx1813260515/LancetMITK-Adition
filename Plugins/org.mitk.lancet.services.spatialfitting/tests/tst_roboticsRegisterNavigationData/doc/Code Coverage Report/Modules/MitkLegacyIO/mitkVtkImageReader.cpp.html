<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkVtkImageReader.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkVtkImageReader.h"

#include &lt;vtkDataReader.h&gt;
#include &lt;vtkStructuredPoints.h&gt;
#include &lt;vtkStructuredPointsReader.h&gt;

<span style = "background-color:#fdd">mitk::VtkImageReader::VtkImageReader() : m_FileName(""), m_FilePrefix(""), m_FilePattern("")
{
}</span>

mitk::VtkImageReader::~VtkImageReader()
<span style = "background-color:#fdd">{
}</span>

void mitk::VtkImageReader::GenerateData()
<span style = "background-color:#fdd">{
  if (m_FileName != "")</span>
  {
<span style = "background-color:#fdd">    MITK_INFO &lt;&lt; "Loading " &lt;&lt; m_FileName &lt;&lt; " as vtk" &lt;&lt; std::endl;</span>

    /// We create a Generic Reader to test de .vtk/
<span style = "background-color:#fdd">    vtkDataReader *chooser = vtkDataReader::New();
    chooser-&gt;SetFileName(m_FileName.c_str());</span>

<span style = "background-color:#fdd">    if (chooser-&gt;IsFileStructuredPoints())</span>
    {
      /// StructuredPoints/
<span style = "background-color:#fdd">      MITK_INFO &lt;&lt; "StructuredPoints" &lt;&lt; std::endl;
      vtkStructuredPointsReader *reader = vtkStructuredPointsReader::New();
      reader-&gt;SetFileName(m_FileName.c_str());
      reader-&gt;Update();</span>

<span style = "background-color:#fdd">      if (reader-&gt;GetOutput() != nullptr)</span>
      {
<span style = "background-color:#fdd">        mitk::Image::Pointer output = this-&gt;GetOutput();
        output-&gt;Initialize(reader-&gt;GetOutput());
        output-&gt;SetVolume(reader-&gt;GetOutput()-&gt;GetScalarPointer());
      }
      reader-&gt;Delete();
    }</span>
    else
    {
<span style = "background-color:#fdd">      MITK_ERROR &lt;&lt; " ... sorry, this .vtk format is not supported yet." &lt;&lt; std::endl;</span>
    }
<span style = "background-color:#fdd">    chooser-&gt;Delete();</span>
  }
<span style = "background-color:#fdd">}</span>

bool mitk::VtkImageReader::CanReadFile(const std::string filename,
                                       const std::string /*filePrefix*/,
                                       const std::string /*filePattern*/)
<span style = "background-color:#fdd">{</span>
  // First check the extension
<span style = "background-color:#fdd">  if (filename == "")
    return false;</span>

<span style = "background-color:#fdd">  bool extensionFound = false;
  std::string::size_type PVTKPos = filename.rfind(".pvtk");
  if ((PVTKPos != std::string::npos) &amp;&amp; (PVTKPos == filename.length() - 5))</span>
  {
<span style = "background-color:#fdd">    extensionFound = true;</span>
  }

<span style = "background-color:#fdd">  PVTKPos = filename.rfind(".PVTK");
  if ((PVTKPos != std::string::npos) &amp;&amp; (PVTKPos == filename.length() - 5))</span>
  {
<span style = "background-color:#fdd">    extensionFound = true;</span>
  }

<span style = "background-color:#fdd">  if (extensionFound)</span>
  {
<span style = "background-color:#fdd">    vtkDataReader *chooser = vtkDataReader::New();
    chooser-&gt;SetFileName(filename.c_str());
    if (!chooser-&gt;IsFileStructuredPoints())
      return false;
  }</span>
  else
<span style = "background-color:#fdd">    return false;</span>

<span style = "background-color:#fdd">  return true;
}</span></pre>
	</body>
</html>