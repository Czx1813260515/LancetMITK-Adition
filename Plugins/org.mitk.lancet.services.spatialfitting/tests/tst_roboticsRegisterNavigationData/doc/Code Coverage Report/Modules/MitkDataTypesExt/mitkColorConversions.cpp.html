<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>mitkColorConversions.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
/*============================================================================

The Medical Imaging Interaction Toolkit (MITK)

Copyright (c) German Cancer Research Center (DKFZ)
All rights reserved.

Use of this source code is governed by a 3-clause BSD license that can be
found in the LICENSE file.

============================================================================*/

#include "mitkColorConversions.h"

namespace mitk
{
  namespace ColorConversions
  {
    /*
       Convert HSV color to RGB color (pseudocode from wikipedia)

       H from 0 to 360
       S from 0 to 1
       V from 0 to 1

       R, G, and B from 0 to 1
    */
    void Hsv2Rgb(float h, float s, float v, float &amp;r, float &amp;g, float &amp;b)
<span style = "background-color:#fdd">    {
      if (s == 0.0)</span>
      {
<span style = "background-color:#fdd">        r = g = b = v; // gray
        return;</span>
      }

<span style = "background-color:#fdd">      int Hi = (int)(h / 60.0) % 6;
      if (h &gt;= 360)
        Hi = 6;</span>

<span style = "background-color:#fdd">      auto f = (float)(h / 60.0 - (float)Hi);
      auto p = (float)(v * (1.0 - s));
      auto q = (float)(v * (1.0 - s * f));
      auto t = (float)(v * (1.0 - s * (1.0 - f)));</span>

<span style = "background-color:#fdd">      switch (Hi)</span>
      {
        case 0:
        case 6:
<span style = "background-color:#fdd">          r = v;
          g = t;
          b = p;
          break;</span>
        case 1:
<span style = "background-color:#fdd">          r = q;
          g = v;
          b = p;
          break;</span>
        case 2:
<span style = "background-color:#fdd">          r = p;
          g = v;
          b = t;
          break;</span>
        case 3:
<span style = "background-color:#fdd">          r = p;
          g = q;
          b = v;
          break;</span>
        case 4:
<span style = "background-color:#fdd">          r = t;
          g = p;
          b = v;
          break;</span>
        case 5:
<span style = "background-color:#fdd">          r = v;
          g = p;
          b = q;</span>
          break;
      }
<span style = "background-color:#fdd">    }</span>
    /*
       Convert RGB color to HSV color

       R from 0 to 1
       G from 0 to 1
       B from 0 to 1

       H from 0 to 360 and -1 for undefined color (pure white)
       S from 0 to 1
       V from 0 to 1
    */
    void Rgb2Hsv(float r, float g, float b, float &amp;h, float &amp;s, float &amp;v)
<span style = "background-color:#fdd">    {</span>
      /* r = r/255;
       b = b/255;
       g = g/255;*/

<span style = "background-color:#fdd">      float mn = r, mx = r;
      int maxVal = 0;</span>

<span style = "background-color:#fdd">      if (g &gt; mx)</span>
      {
<span style = "background-color:#fdd">        mx = g;
        maxVal = 1;</span>
      }
<span style = "background-color:#fdd">      if (b &gt; mx)</span>
      {
<span style = "background-color:#fdd">        mx = b;
        maxVal = 2;</span>
      }
<span style = "background-color:#fdd">      if (g &lt; mn)
        mn = g;
      if (b &lt; mn)
        mn = b;</span>

<span style = "background-color:#fdd">      float delta = mx - mn;</span>

<span style = "background-color:#fdd">      v = mx;
      if (mx != 0)
        s = delta / mx;</span>
      else
      {
<span style = "background-color:#fdd">        s = 0;
        h = 0;
        return;</span>
      }
<span style = "background-color:#fdd">      if (s == 0.0f)</span>
      {
<span style = "background-color:#fdd">        h = -1;
        return;
      }</span>
      else
      {
<span style = "background-color:#fdd">        switch (maxVal)</span>
        {
          case 0:
          {
<span style = "background-color:#fdd">            h = (g - b) / delta;
            break;</span>
          } // yel &lt; h &lt; mag
          case 1:
          {
<span style = "background-color:#fdd">            h = 2 + (b - r) / delta;
            break;</span>
          } // cyan &lt; h &lt; yel
          case 2:
          {
<span style = "background-color:#fdd">            h = 4 + (r - g) / delta;</span>
            break;
          } // mag &lt; h &lt; cyan
        }
      }

<span style = "background-color:#fdd">      h *= 60;
      if (h &lt; 0)
        h += 360;
    }</span>

  } // ColorConversion

} // mitk</pre>
	</body>
</html>